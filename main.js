(()=>{"use strict";var e={56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{var n=[];function t(e){for(var t=-1,r=0;r<n.length;r++)if(n[r].identifier===e){t=r;break}return t}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var l=e[s],u=r.base?l[0]+r.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=t(d),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)n[p].references++,n[p].updater(f);else{var h=o(f,r);r.byIndex=s,n.splice(s,0,{identifier:d,updater:h,references:1})}a.push(d)}return a}function o(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=t(i[a]);n[s].references--}for(var l=r(e,o),u=0;u<i.length;u++){var c=t(i[u]);0===n[c].references&&(n[c].updater(),n.splice(c,1))}i=l}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",r=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),r&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),r&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);r&&a[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),n.push(c))}},n}},365:(e,n,t)=>{t.d(n,{A:()=>s});var r=t(601),o=t.n(r),i=t(314),a=t.n(i)()(o());a.push([e.id,":root {\n  --dark-background: #0c244a;\n  --light-background: #e6ecf5;\n  --light-text-color: #e6ebf2;\n  --cell-size: 50px;\n  --default-cell-hover: #8db39c;\n  --water-cell-color: #8ab7ff;\n  --hit-ship-color: #917471;\n}\n\n*,\n*::before,\n*::after {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  height: 100vh;\n  display: grid;\n  grid-template: auto 1fr auto / 1fr;\n  font-size: 1rem;\n  line-height: 1.5;\n  font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;\n  background-color: var(--light-background);\n}\n\na {\n  color: inherit;\n  text-decoration: none;\n}\n\na:hover {\n  text-decoration: underline;\n}\n\nheader,\nfooter {\n  background-color: var(--dark-background);\n  color: var(--light-text-color);\n  text-align: center;\n}\n\nheader {\n  padding: 16px 0;\n}\n\nfooter {\n  padding: 2px 0;\n}\n\nmain {\n  display: grid;\n  grid-template: auto auto / auto 1fr auto 1fr auto;\n  justify-items: center;\n  align-items: center;\n}\n\nmain>div {\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.right {\n  margin-right: 5vw;\n}\n\n.left {\n  margin-left: 5vw;\n}\n\n.right,\n.left {\n  text-align: right;\n}\n\n.message-container {\n  grid-area: 1 / 1 / 2 / 6;\n  font-size: 1.6rem;\n  font-weight: 700;\n  align-self: end;\n  position: relative;\n  min-width: 700px;\n}\n\n.previous-message {\n  position: absolute;\n  bottom: 30px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: rgba(0, 0, 0, .3);\n  font-size: 1.3rem;\n}\n\n.board-container {\n  display: grid;\n  grid-template: auto / repeat(10, auto);\n  box-shadow: 2px 2px 2px rgba(0, 0, 0, .1);\n  gap: 1px;\n  background-color: var(--dark-background);\n  border: 1px solid var(--dark-background);\n}\n\n.cell {\n  background-color: #fff;\n  width: var(--cell-size);\n  height: var(--cell-size);\n  border: none;\n}\n\n.cell:hover,\n.cell:active {\n  cursor: pointer;\n  background-color: var(--default-cell-hover);\n  outline: none;\n}\n\n.ship,\n.ship:hover {\n  background-color: #888;\n}\n\n.water,\n.water:hover {\n  background-color: var(--water-cell-color);\n}\n\n.hit,\n.hit:hover {\n  background-color: var(--hit-ship-color);\n}\n\n.inactive {\n  filter: grayscale(80%) brightness(80%);\n  pointer-events: none;\n}\n\n.uninteractive {\n  pointer-events: none;\n}\n\n.sunk {\n  color: red;\n}\n\n#hint {\n  background: none;\n  border: none;\n  font-size: 1.3rem;\n  font-weight: 700;\n  pointer-events: none;\n  outline: none;\n}\n",""]);const s=a},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var n={};e.exports=function(e,t){var r=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var i=t.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={id:r,exports:{}};return e[r](i,i.exports,t),i.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;var r=t(72),o=t.n(r),i=t(825),a=t.n(i),s=t(659),l=t.n(s),u=t(56),c=t.n(u),d=t(540),p=t.n(d),f=t(113),h=t.n(f),m=t(365),g={};g.styleTagTransform=h(),g.setAttributes=c(),g.insert=l().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=p(),o()(m.A,g),m.A&&m.A.locals&&m.A.locals;const b=(()=>{const e={};function n(n,t){e[n]=e[n]?.filter(e=>e!=t)??[]}return{subscribe:function(t,r){return e[t]??=[],e[t].push(r),()=>n(t,r)},unsubscribe:n,publish:function(n,t){e[n]?.forEach(e=>e(t))}}})(),v=b,y=((()=>{function e(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function n(e){let n;if(e){n="human"===e?Array.from(document.querySelectorAll(".cell")).slice(0,100):Array.from(document.querySelectorAll(".cell")).slice(100,200);for(let e of n)e.classList.toggle("uninteractive")}else{n=document.querySelectorAll(".cell");for(let e of n)e.classList.toggle("inactive")}}function t(n,t){if(e(document.querySelector(".middle")),!n)return;const r=document.querySelector(".middle"),o=document.createElement("button");o.innerHTML=n,o.id=t,r.appendChild(o),v.publish("buttons:rendered",o)}v.subscribe("shipList:reseted",function(e){for(;e[0];){let t=e.shift();n(t,"left"),n(t,"right")}function n(e,n){const t=document.querySelectorAll(`.${n}>p`);for(const n of t)if(n.textContent.includes(e)&&n.classList.contains("sunk")){n.classList.remove("sunk");let t=n.textContent.split("");t.pop(),t.push(e),n.textContent=t.join("")}}}),v.subscribe("ships:created",t),v.subscribe("boards:toggled",n),v.subscribe("game:ended",function(r){e(document.querySelector(".middle")),n(),t("Play again","play-again")}),v.subscribe("message:updated",function([e,n]){const t=document.querySelector(".previous-message"),r=document.querySelector(".message");"human"===n?r.textContent=e:"ai"===n?t.textContent=e:(t.textContent="",r.textContent=e)}),v.subscribe("players:created",function(n){e(document.querySelector(".middle"));const r=document.querySelectorAll(".board-container");let o=r[0];for(const t of Object.keys(n)){e(o);for(const e of n[t].gb.board.domElements)o.appendChild(e);o=r[1]}t("Drag on your board<br>to place your ships","hint")}),v.subscribe("ship:sunk",function([e,n]){const t="human"!==e?"left":"right",r=document.querySelectorAll(`.${t}>p`);for(const e of r)if(e.textContent.includes(n)&&!e.classList.contains("sunk")){e.classList.add("sunk");let n=e.textContent.split("");return n.pop(),n.push("0"),void(e.textContent=n.join(""))}})})(),e=>{let n=0;return{hit:()=>{n!==e&&n++},isSunk:()=>n===e,getHits:()=>n,getSize:()=>e}}),x=()=>{const e={min:0,max:9,maxShipSize:5,minShipSize:1,occupied:new Set,totalShips:0,sunkenShips:0,attacked:new Set,domElements:[]},n=[];function t(n){for(let t of e.occupied)for(let e of n)if(e.toString()===t.split(":")[1])return t.split(":");return!1}function r(e,n){let[t,r,o,i,a]=function(e,n){let t,r,o,i,a;return e[0]!==n[0]?(r=e[0],t=e[1],o=e[0]<n[0]?1:-1,i="y",a=n[0]):e[1]!==n[1]?(r=e[1],t=e[0],o=e[1]<n[1]?1:-1,i="x",a=n[1]):(r=e[0],t=e[1],o=1,i="x",a=n[0]),[t,r,o,i,a]}(e,n),s=[];for(;r!==a+o;){let e="x"===i?[t,r]:[r,t];s.push(e),r+=o}return s}function o(n){for(let t of n)if(t<e.min||t>e.max)return!0;return!1}return function(){for(let n=0;n<=e.max;n++)for(let t=0;t<=e.max;t++){const r=document.createElement("button");r.classList.add("cell"),r.id=`${n},${t}`,e.domElements.push(r)}}(),{newShip:function(i,a,s=void 0){if(function(e,n){return e[0]!==n[0]&&e[1]!==n[1]}(i,a))return!1;if(o(i)||o(a))return!1;const l=Math.abs(i[0]-a[0]||i[1]-a[1])+1;if(function(n){return n<e.minShipSize||n>e.maxShipSize}(l))return!1;const u={id:n.length,ship:y(l),path:r(i,a)};return!t(u.path)&&(function(n,t){for(let r of n.path)if(e.occupied.add(`${n.id}:${r}`),t)for(let n of e.domElements)n.id===r.toString()&&n.classList.add(t)}(u,s),n.push(u),e.totalShips++,!0)},receiveAttack:function(r,o){let i=t([r])[0];for(const n of e.attacked)if(n===r.toString())return!1;if(e.attacked.add(r.toString()),i){for(let t of n)i===t.id.toString()&&(t.ship.hit(),t.ship.isSunk()?(e.sunkenShips++,"human"===o?(v.publish("message:updated",["You sunk an enemy ship",o]),v.publish("ship:sunk",[o,t.ship.getSize()])):(v.publish("message:updated",["The enemy sunk one of your ships",o]),v.publish("ship:sunk",[o,t.ship.getSize()]))):"human"===o?v.publish("message:updated",["You hit an enemy ship",o]):v.publish("message:updated",["The enemy hit one of your ships",o]));for(let n of e.domElements)n.id===r.toString()&&(n.classList.add("ship"),n.classList.add("hit"));return e.sunkenShips===e.totalShips&&("human"===o?v.publish("message:updated",["You win! All enemy ships are gone, congratulations.",o]):v.publish("message:updated",["You lose, all your ships are gone.",o]),v.publish("game:ended",o)),!0}for(let n of e.domElements)n.id===r.toString()&&n.classList.add("water");return"human"===o?v.publish("message:updated",["You hit water",o]):v.publish("message:updated",["The enemy hit water",o]),!0},board:e}},S=()=>({gb:x()});(()=>{let e,n=!0;function t(){e={human:S(),ai:S()},v.publish("players:created",e),n=!0,function(){const t=Array.from(document.querySelectorAll(".cell")).slice(0,100);let r=[5,4,3,3,2],o=null;function i(e){return e.split(",").map(Number)}t.forEach(t=>{t.addEventListener("mousedown",()=>{o=i(t.id)}),t.addEventListener("mouseup",()=>{if(!o)return;const a=i(t.id),s=function(e){let n=-1;if(e[0][0]===e[1][0])n=e[0][1]-e[1][1];else{if(e[0][1]!==e[1][1])return n;n=e[0][0]-e[1][0]}return Math.abs(n)+1}([o,a]);r.includes(s)&&(e.human.gb.newShip(o,a,"ship"),r.splice(r.indexOf(s),1)),o=null,r.length<1&&(v.publish("ships:created"),function(){let n=[5,4,3,3,2],t=0;for(;t<n.length;){const r=n[t];let o=Math.random()<.5,i=Math.floor(10*Math.random()),a=Math.floor(10*Math.random()),s=i,l=a;o?(l=a+r-1,l>=10&&(a=a-r+1,l=a+r-1)):(s=i+r-1,s>=10&&(i=i-r+1,s=i+r-1)),e.ai.gb.newShip([i,a],[s,l],"ai-ship")&&t++}}(),Array.from(document.querySelectorAll(".cell")).slice(100,200).forEach(t=>{t.addEventListener("click",()=>{if(n){let r=[Number(t.id[0]),Number(t.id[2])];e.ai.gb.receiveAttack(r,"human")&&(n=!1,v.publish("boards:toggled","human"),function(){let t=!1;for(;!t;){let r=Math.floor(Math.random()*e.human.gb.board.domElements.length),o=e.human.gb.board.domElements[r],i=[Number(o.id[0]),Number(o.id[2])];e.human.gb.receiveAttack(i,"ai")&&(t=!0,n=!0,v.publish("boards:toggled","human"))}}())}})}),v.publish("boards:toggled","human"))})})}()}v.subscribe("page:loaded",t),v.subscribe("buttons:rendered",function(e){e.addEventListener("click",()=>{"play-again"===e.id&&(v.publish("boards:toggled"),v.publish("message:updated",["Place your ships","controller"]),t(),v.publish("shipList:reseted",[5,4,3,3,2]))})})})(),document.addEventListener("DOMContentLoaded",()=>{v.publish("page:loaded")})})();